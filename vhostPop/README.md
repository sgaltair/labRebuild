# Compose File Vhost Creator
##### README generated by ChatGPT and edited

This script is designed to be run alongside nginxproxy/nginx-proxy Docker container. It recursively checks a target directory for compose files with a VIRTUAL_HOST environment variable and creates the corresponding vhost file in the target vhost directory. It also has the option to create a Linode domain record if the `LINODE_INTEGRATION` flag is set to `True`.

## Prerequisites

- This script requires the following Python modules to be installed:
  - `pathlib`
  - `re`
  - `shutil`
  - `datetime`
  - `os`
  - `vhostPopConfig` (imported from external module)
  - `linodeRecordCreate` (imported from external module)

## Usage

A default config file has been provided to you. Please copy this file from `defaultConfig.py` to `vhostPopConfig.py` and edit it.


1. Make sure you have the necessary prerequisites installed.
2. Set the `LINODE_INTEGRATION` flag to `True` if you want to enable Linode domain record creation. Set it to `False` if not needed.
    - If you do choose Linode API integration:
      - You'll need to create a personal access token.
      - You'll need to set the appropriate variables in `vhostPopConfig`.
3. Run the script.

## Functionality

1. The script determines its own path and changes to it, making paths easier to work with.
2. It creates a log file if it doesn't exist already.
3. It throws errors if vital paths do not exist.
4. It searches for compose files named `compose.yml` or `docker-compose.yml` in the specified directory.
5. The `timestamp` function returns the current time and date as a formatted string.
6. The `writeLog` function writes logs to the file based on the log type (`error` or `info`), ensuring the log file never exceeds 1000 lines.
7. The `main` function performs the following tasks:
   - Writes the default initial host file if it doesn't exist.
   - Checks for the `VIRTUAL_HOST` environment variable in all found compose files.
   - If a `VIRTUAL_HOST` is present and the corresponding vhost file doesn't exist, it creates it using the default.
   - If `LINODE_INTEGRATION` is enabled, it attempts to create the Linode domain record for the vhost.
8. The script can be executed directly if required.

**Note:** Ensure that the external modules `vhostPopConfig` and `linodeRecordCreate` are present and accessible for the script to run successfully.